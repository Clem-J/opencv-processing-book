<html>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script>
var data = {"title":"BrightnessTracking.pde","results":[{"code":"import gab.opencvpro.*;\n\nOpenCV opencv;\n\nvoid setup() {\n  opencv = new OpenCV(this, \"flashlight.jpg\");  \n  size(opencv.width, opencv.height, P2D);\n}\n\nvoid draw() {\n  image(opencv.getOutput(), 0, 0); \n}","illustration_embed":"<a href=\"http://www.flickr.com/photos/unavoidablegrain/9225754686/\" title=\"image1 by atduskgreg, on Flickr\"><img src=\"http://farm4.staticflickr.com/3760/9225754686_8cb205c73d.jpg\" width=\"500\" height=\"358\" alt=\"image1\"></a>","comments":["We start with a still image as a test.", "This is OpenCV hello world: load the image in, and display it.", "Note that OpenCV for Processing converts the image to grayscale by default."]},{"code":"import gab.opencvpro.*;\n\nOpenCV opencv;\n\nvoid setup() {\n  opencv = new OpenCV(this, \"flashlight.jpg\");  \n  size(opencv.width, opencv.height, P2D);\n}\n\nvoid draw() {\n  image(opencv.getOutput(), 0, 0); \n  PVector brightestPoint = opencv.max();\n  \n  noStroke();\n  fill(255, 0, 0);\n  ellipse(brightestPoint.x, brightestPoint.y, 20, 20);\n}","illustration_embed":"<a href=\"http://www.flickr.com/photos/unavoidablegrain/9225754450/\" title=\"image2 by atduskgreg, on Flickr\"><img src=\"http://farm6.staticflickr.com/5491/9225754450_a8780f2c74.jpg\" width=\"500\" height=\"358\" alt=\"image2\"></a>","comments":["Call <code>opencv.max()</code> to find the location of the brightest point in the iamge.","We then display that x-y location with a red ellipse."]},{"code":"import gab.opencvpro.*;\nimport processing.video.*;\n\nCapture video;\nOpenCV opencv;\n\nvoid setup() {\n  video = new Capture(this, 1280, 720);\n  opencv = new OpenCV(this, video.width, video.height);  \n  size(opencv.width, opencv.height, P2D);\n  \n  video.start();\n}\n\nvoid draw() {\n  opencv.loadImage(video);\n  image(opencv.getOutput(), 0, 0); \n  PVector brightestPoint = opencv.max();\n  \n  noStroke();\n  fill(255, 0, 0);\n  ellipse(brightestPoint.x, brightestPoint.y, 20, 20);\n}\n\nvoid captureEvent(Capture c) {\n  c.read();\n}","illustration_embed":"<iframe src=\"http://player.vimeo.com/video/69805961\" width=\"500\" height=\"281\" frameborder=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe> ","comments":["Add the processing video library and declare a Capture object","Intialize the Capture object with the width and height of our camera", "Set our OpenCV object to have the same dimensions as the input video" ,"Start video capture going.","Then the rest of the sketch proceeds as before: show the grayscale image, find the max, draw a red ellipse on top of it."]},{"code":"import gab.opencvpro.*;\nimport processing.video.*;\n\nCapture video;\nOpenCV opencv;\n\nvoid setup() {\n  video = new Capture(this, 1280, 720);\n  opencv = new OpenCV(this, video.width, video.height);  \n  size(opencv.width, opencv.height, P2D);\n  \n  video.start();\n}\n\nvoid draw() {\n  opencv.loadImage(video);\n  opencv.setBufferGray(opencv.getBufferG());\n  image(opencv.getOutput(), 0, 0); \n  PVector brightestPoint = opencv.min();\n  \n  noStroke();\n  fill(255, 0, 0);\n  ellipse(brightestPoint.x, brightestPoint.y, 20, 20);\n}\n\nvoid captureEvent(Capture c) {\n  c.read();\n}","illustration_embed":"<iframe src=\"http://player.vimeo.com/video/69811466\" width=\"500\" height=\"281\" frameborder=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>","comments":["Find the <code>max()</code> of the green channel. Brighter parts of the color channels represent more intense areas of green."]}]};

$(window).load(function () {

	$("#widgetTitle h3").html(data.title);
	var imgDiv = $("<div>");
	imgDiv.attr("id", "widgetImage");
	// imgDiv.append("<img>");

	var codeDiv = $("<div>");
	codeDiv.attr("id", "codeZone");

	var scriptTag = $("<pre>");
	codeDiv.append(scriptTag);

	var commentsDiv = $("<div>");
	commentsDiv.attr("id", "codeComments");
	var commentsList = $("<ul>");
	
	commentsDiv.append(commentsList);

	$("#widgetBody").prepend(commentsDiv);
	$("#widgetBody").prepend(codeDiv);
	$("#widgetBody").prepend(imgDiv);

	var currentVersion = 0;
	var numVersions = data.results.length;

	var updateProgress = function(){
		$("#progress").html((currentVersion+1) + "/" + numVersions);
	};

	var updateLinks = function(){
		$("#next").show();
		$("#previous").show();

		if(currentVersion >= (numVersions - 1)){
			$("#next").hide();
		}

		if(currentVersion === 0){
			$("#previous").hide();
		}

		updateProgress();
	};

	var updateBody = function(){
		$("#widgetImage").html(data.results[currentVersion].illustration_embed);
		$("#widgetBody pre").html(data.results[currentVersion].code);
			
		$("#codeComments ul").empty();
		for(var i = 0; i < data.results[currentVersion].comments.length; i++){
			var comment = $("<li>")
			comment.html(data.results[currentVersion].comments[i]);
			commentsList.append(comment);
		}
	}

	updateProgress();
	updateLinks();
	updateBody();

	$("#next").click(function(){
		currentVersion = currentVersion + 1;
		updateLinks();
		updateBody();
		return false;
	});

	$("#previous").click(function(){
		currentVersion = currentVersion - 1;
		updateLinks();
		updateBody();
		return false;
	});
});
</script>
<style>
	#widget {
		width: 1300px;
	}

	#widgetBody{
		border: 3px solid #000;
	}

	#widgetBody div {
		float: left;
		/*padding:7px;*/
	}

	#codeZone {
		border-left: 1px solid #ccc;
		border-right: 1px solid #ccc;
		width: 500px;
		padding-left:20px;
	}

	#codeComments{
		width: 200px;
	}

	#widgetBody img {
		/*width: 350px;*/
		/*padding: 25px;*/
		padding: 0;
		margin: 0;
		width: 100%;
	}

	.navButton {
		float:left;
		padding: 3px;
		padding-right: 50px;
		background-color: #000;
		margin-right: 10px;
		color: #fff;
	}

	#progress {
		padding: 3px;
		background-color: #fff;
		color: #000;
		margin-right: 10px;
		float: left;
	}

	#widgetControls a {
		color: #fff;
		font-weight: bold;
		text-decoration: none;
	}

	#widgetTitle {
		float: right;
		text-align: right;

	}

	#widgetTitle h3{
		margin: 0;
		padding: 0;
	}
</style>
<head>
</head>
<body>
	<div id="widget">
		<div id="widgetTitle"><h3>Title</hr></div>

		<div id="widgetControls">
			<div id="progress"></div>
			<div class="navButton" id="previous"><a href="#">Previous</a></div>
			<div class="navButton" id="next"><a href="#">Next</a></div>
		</div>

		<br style="clear:both" />
		<div id="widgetBody">
			<br style="clear:both;"/>
		</div>
	</div>
</body>
</html>
